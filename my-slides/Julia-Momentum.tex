\documentclass[\string~/GitHub/sthlmNordBeamerTheme/sthlmNordLightDemo.tex]{subfiles}

\begin{document}
%   FRAME START   -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
\begin{frame}[allowframebreaks, allowdisplaybreaks, t, fragile]{Momentum Solver}{Runge-Kutta}

    \begin{center}
        \begin{minted}[linenos, breaklines, fontfamily=helvetica, fontsize=\tiny]{julia}
            let coefficient = [1/4 1/3 1/2 1]
                iter_stp = 0
                iter_err = 1
            while ( iter_stp < maxiter ) && ( iter_err > tol )
                u_im_x = deepcopy(u_p_x)
                u_im_y = deepcopy(u_p_y)
                dt = deepcopy(CSolution.dt)

                for stage in 1:4
                    rhs_x, rhs_y = rhs_calc(CSolution, convec_coeff)

                    rhs_x = rhs_x - ( 1.5/dt )*( u_im_x - ucur_x ) + ( 0.5/dt )*( du_x )
                    rhs_y = rhs_y - ( 1.5/dt )*( u_im_y - ucur_y ) + ( 0.5/dt )*( du_y )

                    # Update Immidiate Velocity components
                    u_im_x = u_p_x + coefficient[stage]*dt*0.4*rhs_x
                    u_im_y = u_p_y + coefficient[stage]*dt*0.4*rhs_y

                    global CSolution.ucur_x = u_im_x
                    global CSolution.ucur_y = u_im_y

                    form_bcs(CSolution)
                end
            end
        \end{minted}
    \end{center}
    
\end{frame}
%   FRAME END   --==-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

%   FRAME START   -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
\begin{frame}[allowframebreaks, allowdisplaybreaks, t, fragile]{Momentum Solver}{Viscous Flux}

    \begin{center}
        \begin{minted}[linenos, breaklines, fontfamily=helvetica, fontsize=\tiny]{julia}
            for ii = 2:M-1
                for jj = 2:N-1
                    ue = ucat_x[ii-1, jj]
                    up = ucat_x[  ii, jj]
                    uw = ucat_x[ii+1, jj]
                    un = ucat_x[ii, jj-1]
                    us = ucat_x[ii, jj+1]
                    ve = ucat_y[ii-1, jj]
                    vp = ucat_y[  ii, jj]
                    vw = ucat_y[ii+1, jj]
                    vn = ucat_y[ii, jj-1]
                    vs = ucat_y[ii, jj+1]
                    
                    visc_flux_x[ii, jj] = ( uw - 2*up + ue )./( dx*dx ) + ( us - 2*up + un )./( dy*dy )
                    visc_flux_y[ii, jj] = ( vw - 2*vp + ve )./( dx*dx ) + ( vs - 2*vp + vn )./( dy*dy )
                end
            end
        \end{minted}
    \end{center}

    \framebreak

    \begin{center}
        \begin{minted}[linenos, breaklines, fontfamily=helvetica, fontsize=\tiny]{julia}
            for ii = 1:M
                visc_flux_x[ii, 1] = 0
                visc_flux_y[ii, 1] = 0
                visc_flux_x[ii, N] = 0
                visc_flux_y[ii, N] = 0
            end

            for jj = 1:N
                visc_flux_x[1, jj] = 0
                visc_flux_y[1, jj] = 0
                visc_flux_x[1, jj] = 0
                visc_flux_y[1, jj] = 0
            end

            visc_flux_x = visc_flux_x/ren
            visc_flux_y = visc_flux_y/ren

            return visc_flux_x, visc_flux_y
        \end{minted}
    \end{center}
    
\end{frame}
%   FRAME END   --==-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

%   FRAME START   -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
\begin{frame}[allowframebreaks, allowdisplaybreaks, t, fragile]{Momentum Solver}{Convective Flux}

    \begin{center}
        \begin{minted}[linenos, breaklines, fontfamily=helvetica, fontsize=\Tiny]{julia}
            for ii = 1:M-1
            for jj = 1:N
               un = 0.5*ucur_x[ii, jj]
               um = un - abs(un)
               up = un + abs(un)

               vn = 0.5*ucur_y[ii, jj]
               vm = vn - abs(vn)
               vp = vn + abs(vn)

               if ( ii == 1 )
                  fpx1[ii,  jj] = um*( coeff*( - ucat_x[ii+2, jj] - 2*ucat_x[ii+1, jj] + 3*ucat_x[ii, jj] ) + ucat_x[ii+1, jj] ) + up*( coeff*( - ucat_x[ii, jj] - 2*ucat_x[ii, jj] + 3*ucat_x[ii+1, jj] ) + ucat_x[ii, jj] )

                  fpy1[ii,  jj] = vm*( coeff*( - ucat_y[ii+2, jj] - 2*ucat_y[ii+1, jj] + 3*ucat_y[ii, jj] ) + ucat_y[ii+1, jj] ) + vp*( coeff*( - ucat_y[ii, jj] - 2*ucat_y[ii, jj] + 3*ucat_y[ii+1, jj] ) + ucat_y[ii, jj] )
               elseif ( ii == M-1 )
                  fpx1[ii,  jj] = um*( coeff*( - ucat_x[ii+1, jj] - 2*ucat_x[ii+1, jj] + 3*ucat_x[ii, jj] ) + ucat_x[ii+1, jj] ) + up*( coeff*( - ucat_x[ii-1, jj] - 2*ucat_x[ii, jj] + 3*ucat_x[ii+1, jj] ) + ucat_x[ii, jj] )

                  fpy1[ii,  jj] = vm*( coeff*( - ucat_y[ii+1, jj] - 2*ucat_y[ii+1, jj] + 3*ucat_y[ii, jj] ) + ucat_y[ii+1, jj] ) + vp*( coeff*( - ucat_y[ii-1, jj] - 2*ucat_y[ii, jj] + 3*ucat_y[ii+1, jj] ) + ucat_y[ii, jj] )
               else
                  fpx1[ii,  jj] = um*( coeff*( - ucat_x[ii+2, jj] - 2*ucat_x[ii+1, jj] + 3*ucat_x[ii, jj] ) + ucat_x[ii+1, jj] ) + up*( coeff*( - ucat_x[ii-1, jj] - 2*ucat_x[ii, jj] + 3*ucat_x[ii+1, jj] ) + ucat_x[ii, jj] )

                  fpy1[ii,  jj] = vm*( coeff*( - ucat_y[ii+2, jj] - 2*ucat_y[ii+1, jj] + 3*ucat_y[ii, jj] ) + ucat_y[ii+1, jj] ) + vp*( coeff*( - ucat_y[ii-1, jj] - 2*ucat_y[ii, jj] + 3*ucat_y[ii+1, jj] ) + ucat_y[ii, jj] )
               end
            end
         end
         
         for jj = 1:N
            fpx1[M, jj] = 0
            fpy1[M, jj] = 0
         end
        \end{minted}
    \end{center}

    \framebreak

    \begin{center}
        \begin{minted}[linenos, breaklines, fontfamily=helvetica, fontsize=\Tiny]{julia}
            for ii = 1:M
            for jj = 1:N-1
               un = 0.5*ucur_x[ii, jj]
               um = un - abs(un)
               up = un + abs(un)

               vn = 0.5*ucur_y[ii, jj]
               vm = vn - abs(vn)
               vp = vn + abs(vn)

               if ( jj == 1 )
                  fpx2[ii,  jj] = um*( coeff*( - ucat_x[ii, jj+2] - 2*ucat_x[ii, jj+1] + 3*ucat_x[ii, jj] ) + ucat_x[ii, jj+1] ) + up*( coeff*( - ucat_x[ii, jj] - 2*ucat_x[ii, jj] + 3*ucat_x[ii, jj+1] ) + ucat_x[ii, jj] )

                  fpy2[ii,  jj] = vm*( coeff*( - ucat_y[ii, jj+2] - 2*ucat_y[ii, jj+1] + 3*ucat_y[ii, jj] ) + ucat_y[ii, jj+1] ) + vp*( coeff*( - ucat_y[ii, jj] - 2*ucat_y[ii, jj] + 3*ucat_y[ii, jj+1] ) + ucat_y[ii, jj] )
               elseif ( jj == N-1 )
                  fpx2[ii,  jj] = um*( coeff*( - ucat_x[ii, jj+1] - 2*ucat_x[ii, jj+1] + 3*ucat_x[ii, jj] ) + ucat_x[ii, jj+1] ) + up*( coeff*( - ucat_x[ii, jj-1] - 2*ucat_x[ii, jj] + 3*ucat_x[ii, jj+1] ) + ucat_x[ii, jj] )

                  fpy2[ii,  jj] = vm*( coeff*( - ucat_y[ii, jj+1] - 2*ucat_y[ii, jj+1] + 3*ucat_y[ii, jj] ) + ucat_y[ii, jj+1] ) + vp*( coeff*( - ucat_y[ii, jj-1] - 2*ucat_y[ii, jj] + 3*ucat_y[ii, jj+1] ) + ucat_y[ii, jj] )
               else
                  fpx2[ii,  jj] = um*( coeff*( - ucat_x[ii, jj+2] - 2*ucat_x[ii, jj+1] + 3*ucat_x[ii, jj] ) + ucat_x[ii, jj+1] ) + up*( coeff*( - ucat_x[ii, jj-1] - 2*ucat_x[ii, jj] + 3*ucat_x[ii, jj+1] ) + ucat_x[ii, jj] )

                  fpy2[ii,  jj] = vm*( coeff*( - ucat_y[ii, jj+2] - 2*ucat_y[ii, jj+1] + 3*ucat_y[ii, jj] ) + ucat_y[ii, jj+1] ) + vp*( coeff*( - ucat_y[ii, jj-1] - 2*ucat_y[ii, jj] + 3*ucat_y[ii, jj+1] ) + ucat_y[ii, jj] )
               end
            end
         end

         for ii = 1:M
            fpx2[ii, N] = 0
            fpy2[ii, N] = 0
         end
        \end{minted}
    \end{center}

    \framebreak

    \begin{center}
        \begin{minted}[linenos, breaklines, fontfamily=helvetica, fontsize=\tiny]{julia}
            for ii = 2:M-1
            for jj = 2:N-1
               conv_flux_x[ii, jj] = ( fpx1[ii, jj] - fpx1[ii-1, jj] )/dx + ( fpx2[ii, jj] - fpx2[ii, jj-1] )/dy
               conv_flux_y[ii, jj] = ( fpy1[ii, jj] - fpy1[ii-1, jj] )/dx + ( fpy2[ii, jj] - fpy2[ii, jj-1] )/dy
            end
         end

         for ii = 1:M
            conv_flux_x[ii, 1] = 0.0
            conv_flux_y[ii, 1] = 0.0
            conv_flux_x[ii, N] = 0.0
            conv_flux_y[ii, N] = 0.0
         end

         for jj = 1:N
            conv_flux_x[1, jj] = 0.0
            conv_flux_y[1, jj] = 0.0
            conv_flux_x[M, jj] = 0.0
            conv_flux_y[M, jj] = 0.0
         end

         return conv_flux_x, conv_flux_y
        \end{minted}
    \end{center}
    
\end{frame}
%   FRAME END   --==-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

%   FRAME START   -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
\begin{frame}[allowframebreaks, allowdisplaybreaks, t, fragile]{Momentum Solver}{Pressure Gradient}

    \begin{center}
        \begin{minted}[linenos, breaklines, fontfamily=helvetica, fontsize=\Tiny]{julia}
            for ii = 1:M
            for jj = 1:N
               if ( ii == 1 )
                  pres_grad_x[ii, jj] = 0
               elseif ( ii == 2 )
                  pres_grad_x[ii, jj] = ( pres[ii+1, jj] - pres[ii, jj] )/dx
               elseif ( ii == M-1 )
                  pres_grad_x[ii, jj] = ( pres[ii, jj] - pres[ii-1, jj] )/dx
               elseif ( ii == M )
                  pres_grad_x[ii, jj] = 0
               else
                  pres_grad_x[ii, jj] = ( pres[ii+1, jj] - pres[ii-1, jj] )/( 2*dx )
               end

               if ( jj == 1 )
                  pres_grad_y[ii, jj] = 0
               elseif ( jj == 2 )
                  pres_grad_y[ii, jj] = ( pres[ii, jj+1] - pres[ii, jj] )/dy
               elseif ( jj == N-1 )
                  pres_grad_y[ii, jj] = ( pres[ii, jj] - pres[ii, jj-1] )/dy
               elseif ( jj == N )
                  pres_grad_y[ii, jj] = 0
               else
                  pres_grad_y[ii, jj] = ( pres[ii, jj+1] - pres[ii, jj-1] )/( 2*dy )
               end
            end
         end

         return pres_grad_x, pres_grad_y
        \end{minted}
    \end{center}
    
\end{frame}
%   FRAME END   --==-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
\end{document}